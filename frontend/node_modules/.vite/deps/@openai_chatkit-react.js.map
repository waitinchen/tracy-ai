{
  "version": 3,
  "sources": ["../../@openai/chatkit-react/dist/index.js"],
  "sourcesContent": ["// src/ChatKit.tsx\nimport * as React from \"react\";\nimport { jsx } from \"react/jsx-runtime\";\nvar ChatKit = React.forwardRef(\n  function ChatKit2({ control, ...htmlProps }, forwardedRef) {\n    const ref = React.useRef(null);\n    React.useLayoutEffect(() => {\n      const el = ref.current;\n      if (!el) return;\n      if (customElements.get(\"openai-chatkit\")) {\n        el.setOptions(control.options);\n        return;\n      }\n      let active = true;\n      customElements.whenDefined(\"openai-chatkit\").then(() => {\n        if (active) {\n          el.setOptions(control.options);\n        }\n      });\n      return () => {\n        active = false;\n      };\n    }, [control.options]);\n    return /* @__PURE__ */ jsx(\n      \"openai-chatkit\",\n      {\n        ref: (chatKit) => {\n          ref.current = chatKit;\n          control.setInstance(chatKit);\n          if (typeof forwardedRef === \"function\") {\n            forwardedRef(chatKit);\n          } else if (forwardedRef) {\n            forwardedRef.current = chatKit;\n          }\n          if (!ref.current) {\n            return;\n          }\n          const events = {\n            \"chatkit.error\": \"onError\",\n            \"chatkit.response.end\": \"onResponseEnd\",\n            \"chatkit.response.start\": \"onResponseStart\",\n            \"chatkit.log\": \"onLog\",\n            \"chatkit.thread.change\": \"onThreadChange\",\n            \"chatkit.thread.load.start\": \"onThreadLoadStart\",\n            \"chatkit.thread.load.end\": \"onThreadLoadEnd\",\n            \"chatkit.ready\": \"onReady\"\n          };\n          const eventNames = Object.keys(events);\n          for (const event of eventNames) {\n            ref.current.addEventListener(event, (e) => {\n              const handler = control.handlers[events[event]];\n              if (typeof handler === \"function\") {\n                handler(e.detail);\n              }\n            });\n          }\n        },\n        ...htmlProps\n      }\n    );\n  }\n);\n\n// src/useChatKit.ts\nimport * as React3 from \"react\";\n\n// src/useStableOptions.ts\nimport React2 from \"react\";\nfunction isPlainObjectOrArray(obj) {\n  return obj !== null && typeof obj === \"object\" && [null, Object.prototype].includes(Object.getPrototypeOf(obj)) || Array.isArray(obj);\n}\nfunction deepEqualIgnoringFns(a, b, seen = /* @__PURE__ */ new WeakMap()) {\n  if (Object.is(a, b)) return true;\n  if (typeof a === \"function\" && typeof b === \"function\") {\n    return typeof a === typeof b;\n  }\n  if (!isPlainObjectOrArray(a) || !isPlainObjectOrArray(b)) {\n    return false;\n  }\n  const mapped = seen.get(a);\n  if (mapped && mapped === b) return true;\n  seen.set(a, b);\n  if (Array.isArray(a) || Array.isArray(b)) {\n    if (!Array.isArray(a) || !Array.isArray(b) || a.length !== b.length)\n      return false;\n    for (let i = 0; i < a.length; i++) {\n      if (!deepEqualIgnoringFns(a[i], b[i], seen)) return false;\n    }\n    return true;\n  }\n  const aKeys = Object.keys(a);\n  const bKeys = Object.keys(b);\n  if (aKeys.length !== bKeys.length) return false;\n  for (let i = 0; i < aKeys.length; i++) {\n    const k = aKeys[i];\n    if (!Object.prototype.hasOwnProperty.call(b, k)) return false;\n    const av = a[k];\n    const bv = b[k];\n    if (!deepEqualIgnoringFns(av, bv, seen)) return false;\n  }\n  return true;\n}\nfunction withLatestFunctionWrappers(ref) {\n  const path = [];\n  const getByPath = (root, p) => p.reduce((acc, k) => acc == null ? acc : acc[k], root);\n  const wrap = (parentPath, key) => {\n    return (...args) => {\n      const latestParent = getByPath(ref.current, parentPath);\n      const latestFn = latestParent?.[key];\n      if (typeof latestFn === \"function\") {\n        return latestFn.apply(latestParent, args);\n      }\n    };\n  };\n  const visit = (v) => {\n    if (typeof v === \"function\") {\n      const key = path[path.length - 1];\n      const parentPath = path.slice(0, -1);\n      return wrap(parentPath, key);\n    }\n    if (Array.isArray(v)) {\n      const base = path.length;\n      const out = new Array(v.length);\n      for (let i = 0; i < v.length; i++) {\n        path[base] = i;\n        out[i] = visit(v[i]);\n      }\n      path.length = base;\n      return out;\n    }\n    if (v && typeof v === \"object\") {\n      const base = path.length;\n      const out = {};\n      for (const k of Object.keys(v)) {\n        path[base] = k;\n        out[k] = visit(v[k]);\n      }\n      path.length = base;\n      return out;\n    }\n    return v;\n  };\n  return visit(ref.current);\n}\nfunction useStableOptions(options) {\n  const latestOptions = React2.useRef(options);\n  latestOptions.current = options;\n  const cache = React2.useRef(null);\n  if (!cache.current || !deepEqualIgnoringFns(cache.current.snapshot, options)) {\n    cache.current = {\n      snapshot: options,\n      shaped: withLatestFunctionWrappers(latestOptions)\n    };\n  }\n  return cache.current.shaped;\n}\n\n// src/useChatKit.ts\nvar CHATKIT_METHOD_NAMES = Object.freeze([\n  \"focusComposer\",\n  \"setThreadId\",\n  \"sendUserMessage\",\n  \"setComposerValue\",\n  \"fetchUpdates\",\n  \"sendCustomAction\"\n]);\nfunction useChatKit(options) {\n  const ref = React3.useRef(null);\n  const stableOptions = useStableOptions(options);\n  const methods = React3.useMemo(() => {\n    return CHATKIT_METHOD_NAMES.reduce((acc, key) => {\n      acc[key] = (...args) => {\n        if (!ref.current) {\n          console.warn(\"ChatKit element is not mounted\");\n          return;\n        }\n        return ref.current[key](...args);\n      };\n      return acc;\n    }, {});\n  }, []);\n  const setInstance = React3.useCallback(\n    (instance) => {\n      ref.current = instance;\n    },\n    []\n  );\n  const control = React3.useMemo(() => {\n    const options2 = {};\n    const handlers = {};\n    for (const [key, value] of Object.entries(stableOptions)) {\n      if (/^on[A-Z]/.test(key) && key !== \"onClientTool\") {\n        handlers[key] = value;\n      } else {\n        options2[key] = value;\n      }\n    }\n    return {\n      setInstance,\n      options: options2,\n      handlers\n    };\n  }, [stableOptions, setInstance]);\n  return React3.useMemo(\n    () => ({ ...methods, control, ref }),\n    [methods, control]\n  );\n}\nexport {\n  ChatKit,\n  useChatKit\n};\n"],
  "mappings": "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",
  "names": ["React2"]
}
